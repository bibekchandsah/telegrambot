<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Telegram Bot</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
    <!-- favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%2210 0 100 100%22><text y=%221.1em%22 font-size=%2280%22>ğŸ­</text></svg>"></link>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>ğŸ¤– Telegram Bot - Admin Dashboard</h1>
            <div class="header-info">
                <span id="current-time"></span>
            </div>
        </header>

        <!-- Statistics Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">ğŸ‘¥</div>
                <div class="stat-content">
                    <div class="stat-value" id="total-users">-</div>
                    <div class="stat-label">Total Users</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">âœ…</div>
                <div class="stat-content">
                    <div class="stat-value" id="users-with-profiles">-</div>
                    <div class="stat-label">With Profiles</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ğŸŸ¢</div>
                <div class="stat-content">
                    <div class="stat-value" id="active-users">-</div>
                    <div class="stat-label">Active Users</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">â³</div>
                <div class="stat-content">
                    <div class="stat-value" id="users-in-queue">-</div>
                    <div class="stat-label">In Queue</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ğŸ’¬</div>
                <div class="stat-content">
                    <div class="stat-value" id="users-in-chat">-</div>
                    <div class="stat-label">In Chat</div>
                </div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="tabs">
            <button class="tab-button active" data-tab="all-users">All Users</button>
            <button class="tab-button" data-tab="online-users">Online Users</button>
            <button class="tab-button" data-tab="in-chat">In Chat</button>
            <button class="tab-button" data-tab="in-queue">In Queue</button>
            <button class="tab-button" data-tab="search">Search Users</button>
            <button class="tab-button" data-tab="moderation">Moderation</button>
            <button class="tab-button" data-tab="reports">Reports & Safety</button>
            <button class="tab-button" data-tab="shared-data">ğŸ“¤ Shared Data</button>
            <button class="tab-button" data-tab="matching-control">ğŸ¯ Matching Control</button>
            <button class="tab-button" data-tab="bot-settings">âš™ï¸ Bot Settings</button>
            <button class="tab-button" data-tab="backups">ğŸ’¾ Backups</button>
        </div>

        <!-- Tab Content -->
        <div class="tab-content">
            <!-- All Users Tab -->
            <div id="all-users" class="tab-pane active">
                <div class="section-header">
                    <h2>All Users</h2>
                    <button class="btn btn-primary" onclick="loadAllUsers()">ğŸ”„ Refresh</button>
                </div>
                <div class="pagination-info" id="pagination-info"></div>
                <div class="table-container">
                    <table class="user-table">
                        <thead>
                            <tr>
                                <th>Created At</th>
                                <th>Last Activity</th>
                                <th>User ID</th>
                                <th>Username</th>
                                <th>Gender</th>
                                <th>Country</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="all-users-table">
                            <tr>
                                <td colspan="7" class="loading">Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="pagination" id="pagination"></div>
            </div>

            <!-- Online Users Tab -->
            <div id="online-users" class="tab-pane">
                <div class="section-header">
                    <h2>Online Users</h2>
                    <button class="btn btn-primary" onclick="loadOnlineUsers()">ğŸ”„ Refresh</button>
                </div>
                <div class="table-container">
                    <table class="user-table">
                        <thead>
                            <tr>
                                <th>Created At</th>
                                <th>Last Activity</th>
                                <th>User ID</th>
                                <th>Username</th>
                                <th>Gender</th>
                                <th>Country</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="online-users-table">
                            <tr>
                                <td colspan="7" class="loading">Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- In Chat Tab -->
            <div id="in-chat" class="tab-pane">
                <div class="section-header">
                    <h2>Users Currently in Chat</h2>
                    <button class="btn btn-primary" onclick="loadUsersInChat()">ğŸ”„ Refresh</button>
                </div>
                <div class="table-container">
                    <table class="user-table">
                        <thead>
                            <tr>
                                <th>Created At</th>
                                <th>Last Activity</th>
                                <th>User ID</th>
                                <th>Username</th>
                                <th>Gender</th>
                                <th>Country</th>
                                <th>Partner ID</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="in-chat-table">
                            <tr>
                                <td colspan="8" class="loading">Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- In Queue Tab -->
            <div id="in-queue" class="tab-pane">
                <div class="section-header">
                    <h2>Users in Queue</h2>
                    <button class="btn btn-primary" onclick="loadUsersInQueue()">ğŸ”„ Refresh</button>
                </div>
                <div class="table-container">
                    <table class="user-table">
                        <thead>
                            <tr>
                                <th>Created At</th>
                                <th>Last Activity</th>
                                <th>User ID</th>
                                <th>Username</th>
                                <th>Gender</th>
                                <th>Country</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="in-queue-table">
                            <tr>
                                <td colspan="7" class="loading">Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Search Tab -->
            <div id="search" class="tab-pane">
                <div class="section-header">
                    <h2>Search Users</h2>
                </div>
                <div class="search-form">
                    <div class="form-group">
                        <label>User ID:</label>
                        <input type="text" id="search-user-id" placeholder="Enter user ID">
                    </div>
                    <div class="form-group">
                        <label>Username:</label>
                        <input type="text" id="search-username" placeholder="Enter username">
                    </div>
                    <div class="form-group">
                        <label>Gender:</label>
                        <select id="search-gender">
                            <option value="">All</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Country:</label>
                        <input type="text" id="search-country" placeholder="Enter country">
                    </div>
                    <div class="form-group">
                        <label>Sort By:</label>
                        <select id="search-sort-by">
                            <option value="">No Sorting</option>
                            <option value="created_asc">Created At (Oldest First)</option>
                            <option value="created_desc">Created At (Newest First)</option>
                            <option value="activity_asc">Last Activity (Oldest First)</option>
                            <option value="activity_desc">Last Activity (Recent First)</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="searchUsers()">ğŸ” Search</button>
                    <button class="btn btn-secondary" onclick="clearSearch()">Clear</button>
                </div>
                <div class="table-container">
                    <table class="user-table">
                        <thead>
                            <tr>
                                <th>Created At</th>
                                <th>Last Activity</th>
                                <th>User ID</th>
                                <th>Username</th>
                                <th>Gender</th>
                                <th>Country</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="search-results-table">
                            <tr>
                                <td colspan="7" class="no-data">Enter search criteria above</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Moderation Tab -->
        <div id="moderation" class="tab-pane">
            <div class="section-header">
                <h2>User Moderation</h2>
            </div>

            <!-- Ban User Section -->
            <div class="moderation-section">
                <h3>ğŸš« Ban User</h3>
                <div class="search-form">
                    <div class="form-group">
                        <label>User ID:</label>
                        <input type="text" id="ban-user-id" placeholder="Enter user ID to ban">
                    </div>
                    <div class="form-group">
                        <label>Reason:</label>
                        <select id="ban-reason">
                            <option value="">Select reason</option>
                            <option value="nudity">Nudity/Sexual Content</option>
                            <option value="spam">Spam/Advertising</option>
                            <option value="abuse">Verbal Abuse/Harassment</option>
                            <option value="fake_reports">Fake Reports</option>
                            <option value="harassment">Persistent Harassment</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Duration:</label>
                        <select id="ban-duration">
                            <option value="">Select duration</option>
                            <option value="1h">1 Hour</option>
                            <option value="24h">24 Hours</option>
                            <option value="7d">7 Days</option>
                            <option value="30d">30 Days</option>
                            <option value="permanent">Permanent</option>
                        </select>
                    </div>
                    <button class="btn btn-danger" onclick="banUser()">ğŸš« Ban User</button>
                </div>
            </div>

            <!-- Unban User Section -->
            <div class="moderation-section">
                <h3>âœ… Unban User</h3>
                <div class="search-form">
                    <div class="form-group">
                        <label>User ID:</label>
                        <input type="text" id="unban-user-id" placeholder="Enter user ID to unban">
                    </div>
                    <button class="btn btn-success" onclick="unbanUser()">âœ… Unban User</button>
                </div>
            </div>

            <!-- Warn User Section -->
            <div class="moderation-section">
                <h3>âš ï¸ Warn User</h3>
                <div class="search-form">
                    <div class="form-group">
                        <label>User ID:</label>
                        <input type="text" id="warn-user-id" placeholder="Enter user ID to warn">
                    </div>
                    <div class="form-group">
                        <label>Warning Reason:</label>
                        <textarea id="warn-reason" placeholder="Enter warning reason" rows="3"></textarea>
                    </div>
                    <button class="btn btn-warning" onclick="warnUser()">âš ï¸ Issue Warning</button>
                </div>
            </div>

            <!-- Check Ban Status Section -->
            <div class="moderation-section">
                <h3>ğŸ” Check Ban Status</h3>
                <div class="search-form">
                    <div class="form-group">
                        <label>User ID:</label>
                        <input type="text" id="check-ban-user-id" placeholder="Enter user ID to check">
                    </div>
                    <button class="btn btn-primary" onclick="checkBanStatus()">ğŸ” Check Status</button>
                </div>
                <div id="ban-status-result" class="status-result"></div>
            </div>

            <!-- Banned Users List -->
            <div class="moderation-section">
                <div class="section-header">
                    <h3>Banned Users List</h3>
                    <button class="btn btn-primary" onclick="loadBannedUsers()">ğŸ”„ Refresh</button>
                </div>
                <div class="table-container">
                    <table class="user-table">
                        <thead>
                            <tr>
                                <th>User ID</th>
                                <th>Reason</th>
                                <th>Duration</th>
                                <th>Banned At</th>
                                <th>Expires At</th>
                                <th>Banned By</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="banned-users-table">
                            <tr>
                                <td colspan="7" class="loading">Click Refresh to load</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Warned Users List -->
            <div class="moderation-section">
                <div class="section-header">
                    <h3>Warned Users List</h3>
                    <button class="btn btn-primary" onclick="loadWarnedUsers()">ğŸ”„ Refresh</button>
                </div>
                <div class="table-container">
                    <table class="user-table">
                        <thead>
                            <tr>
                                <th>User ID</th>
                                <th>Warning Count</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="warned-users-table">
                            <tr>
                                <td colspan="3" class="loading">Click Refresh to load</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Reports & Safety Tab -->
        <div id="reports" class="tab-pane">
            <div class="section-header">
                <h2>ğŸ›¡ï¸ Reports & Safety Management</h2>
            </div>

            <!-- Report Statistics -->
            <div class="stats-container" style="margin-bottom: 20px;">
                <div class="stat-card">
                    <h3 id="total-reports-count">0</h3>
                    <p>Total Reports</p>
                </div>
                <div class="stat-card">
                    <h3 id="reported-users-count">0</h3>
                    <p>Reported Users</p>
                </div>
                <div class="stat-card">
                    <h3 id="pending-reports-count">0</h3>
                    <p>Pending Reports</p>
                </div>
            </div>

            <!-- User Reports Section -->
            <div class="moderation-section">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h3>ğŸ“‹ User Reports</h3>
                    <button class="btn-primary" onclick="loadAllReports()">ğŸ”„ Refresh Reports</button>
                </div>

                <!-- Filter Controls -->
                <div class="search-form" style="margin-bottom: 15px;">
                    <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                        <div class="form-group" style="margin: 0;">
                            <label style="margin-right: 8px;">Status:</label>
                            <select id="filter-status" onchange="applyReportFilters()" style="padding: 8px;">
                                <option value="all">All Status</option>
                                <option value="pending" selected>Pending</option>
                                <option value="approved">Approved</option>
                                <option value="rejected">Rejected</option>
                            </select>
                        </div>
                        <div class="form-group" style="margin: 0;">
                            <label style="margin-right: 8px;">Flag Type:</label>
                            <select id="filter-flag" onchange="applyReportFilters()" style="padding: 8px;">
                                <option value="all">All Flags</option>
                                <option value="nudity">Nudity</option>
                                <option value="harassment">Harassment</option>
                                <option value="spam">Spam</option>
                                <option value="scam">Scam</option>
                                <option value="fake">Fake Profile</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group" style="margin: 0;">
                            <label style="margin-right: 8px;">User ID:</label>
                            <input type="text" id="filter-userid" placeholder="Filter by User ID"
                                onkeyup="applyReportFilters()" style="padding: 8px; width: 150px;">
                        </div>
                        <button class="btn-primary" onclick="clearReportFilters()" style="padding: 8px 15px;">Clear
                            Filters</button>
                    </div>
                </div>

                <div class="table-container">
                    <table class="user-table">
                        <thead>
                            <tr>
                                <th>Reported User</th>
                                <th>Reporter</th>
                                <th>Flag Type</th>
                                <th>Report Time</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="reports-table">
                            <tr>
                                <td colspan="6" class="loading">Click Refresh to load reports</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Media Blocking Section -->
            <div class="moderation-section">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h3>ğŸš« Media Type Blocking</h3>
                    <button class="btn-primary" onclick="loadBlockedMedia()">ğŸ”„ Refresh</button>
                </div>

                <!-- Block Media Form -->
                <div class="search-form" style="margin-bottom: 15px;">
                    <div class="form-group">
                        <label>Media Type to Block:</label>
                        <select id="block-media-type">
                            <option value="">Select media type</option>
                            <option value="photo">ğŸ“· Photo</option>
                            <option value="video">ğŸ¥ Video</option>
                            <option value="voice">ğŸ¤ Voice</option>
                            <option value="sticker">ğŸ˜Š Sticker</option>
                            <option value="gif">ğŸï¸ GIF</option>
                            <option value="document">ğŸ“„ Document</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Reason:</label>
                        <input type="text" id="block-media-reason" placeholder="Reason for blocking">
                    </div>
                    <div class="form-group">
                        <label>Duration:</label>
                        <select id="block-media-duration">
                            <option value="permanent">Permanent</option>
                            <option value="1h">1 Hour</option>
                            <option value="6h">6 Hours</option>
                            <option value="24h">24 Hours</option>
                            <option value="7d">7 Days</option>
                        </select>
                    </div>
                    <button class="btn-danger" onclick="blockMediaAction()">ğŸš« Block Media</button>
                </div>

                <div class="table-container">
                    <table class="user-table">
                        <thead>
                            <tr>
                                <th>Media Type</th>
                                <th>Blocked At</th>
                                <th>Reason</th>
                                <th>Duration</th>
                                <th>Expires At</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="blocked-media-table">
                            <tr>
                                <td colspan="6" class="loading">Click Refresh to load blocked media</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Bad Word Filter Section -->
            <div class="moderation-section">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h3>ğŸ”¤ Bad Word Filter</h3>
                    <button class="btn-primary" onclick="loadBadWords()">ğŸ”„ Refresh</button>
                </div>

                <!-- Add Bad Word Form -->
                <div class="search-form" style="margin-bottom: 15px;">
                    <div class="form-group">
                        <label>Add Word/Phrase to Filter:</label>
                        <input type="text" id="new-bad-word" placeholder="Enter word or phrase to block">
                    </div>
                    <button class="btn-danger" onclick="addBadWordAction()">â• Add to Filter</button>
                </div>

                <div id="bad-words-container">
                    <p class="loading">Click Refresh to load bad words</p>
                </div>
            </div>

            <!-- Moderation Logs Section -->
            <div class="moderation-section">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h3>ğŸ“œ Moderation Logs</h3>
                    <button class="btn-primary" onclick="loadModerationLogs()">ğŸ”„ Refresh</button>
                </div>
                <div class="table-container">
                    <table class="user-table">
                        <thead>
                            <tr>
                                <th>Timestamp</th>
                                <th>Admin ID</th>
                                <th>Action</th>
                                <th>Target User</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody id="moderation-logs-table">
                            <tr>
                                <td colspan="5" class="loading">Click Refresh to load logs</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Shared Data Tab -->
        <div id="shared-data" class="tab-pane">
            <div class="section-header">
                <h2>ğŸ“¤ Shared Data Monitoring</h2>
                <button class="btn btn-primary" onclick="loadSharedData()">ğŸ”„ Refresh</button>
            </div>

            <div class="info-box">
                <strong>â„¹ï¸ About This Tab:</strong><br>
                This tab tracks all contacts, URLs, and locations shared by users during chats.
                Admins can review this data when users report false or inappropriate information being shared.
            </div>

            <div class="table-container">
                <table class="user-table">
                    <thead>
                        <tr>
                            <th>Timestamp</th>
                            <th>User ID</th>
                            <th>Username</th>
                            <th>Data Type</th>
                            <th>Data</th>
                        </tr>
                    </thead>
                    <tbody id="shared-data-table">
                        <tr>
                            <td colspan="5" class="loading">Click Refresh to load shared data</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Matching Control Tab -->
        <div id="matching-control" class="tab-pane">
            <div class="section-header">
                <h2>ğŸ¯ Matching Control</h2>
                <button class="btn btn-primary" onclick="loadMatchingSettings()">ğŸ”„ Refresh</button>
            </div>

            <!-- Matching Filters Section -->
            <div class="moderation-section">
                <h4 style="margin-top: 0;">ğŸ”§ Matching Filters</h4>
                <p style="margin-bottom: 15px;">Control how users are matched with each other</p>

                <div class="form-group">
                    <label class="toggle-label">
                        <label class="toggle-switch">
                            <input type="checkbox" id="gender-filter-enabled" onchange="updateMatchingFilters()">
                            <span class="toggle-slider"></span>
                        </label>
                        <span>ğŸ‘« Gender Filter</span>
                    </label>
                    <small style="display: block; margin-top: 5px;">When enabled, users are matched based on their
                        gender preferences</small>
                </div>

                <div class="form-group">
                    <label class="toggle-label">
                        <label class="toggle-switch">
                            <input type="checkbox" id="regional-filter-enabled" onchange="updateMatchingFilters()">
                            <span class="toggle-slider"></span>
                        </label>
                        <span>ğŸŒ Regional Filter</span>
                    </label>
                    <small style="display: block; margin-top: 5px;">When enabled, users are matched with others from the
                        same country</small>
                </div>
            </div>

            <!-- Queue Information Section -->
            <div class="moderation-section">
                <h4 style="margin-top: 0;">ğŸ“Š Queue Statistics</h4>

                <div class="stat-row">
                    <div class="stat-item">
                        <div class="stat-label">Current Queue Size:</div>
                        <div class="stat-value-large" id="queue-size-display">-</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Last Updated:</div>
                        <div class="stat-value-large" id="queue-last-updated">-</div>
                    </div>
                </div>

                <button class="btn btn-secondary" onclick="loadQueueSize()" style="margin-top: 15px;">
                    ğŸ”„ Refresh Queue Size
                </button>
            </div>

            <!-- Force Match Section -->
            <div class="force-match-container">
                <h4 style="margin-top: 0;">âš ï¸ Force Match (Debug)</h4>
                <p style="margin-bottom: 15px;">
                    <strong>Warning:</strong> This will forcefully match two specific users, bypassing all filters and
                    queue logic.
                    Use only for debugging purposes.
                </p>

                <div class="form-group">
                    <label>User ID 1:</label>
                    <input type="number" id="force-match-user1" placeholder="Enter first user ID" min="1">
                </div>

                <div class="form-group">
                    <label>User ID 2:</label>
                    <input type="number" id="force-match-user2" placeholder="Enter second user ID" min="1">
                </div>

                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-danger" onclick="forceMatchUsers()">
                        âš¡ Force Match Users
                    </button>
                </div>
            </div>
        </div>

        <!-- Bot Settings Tab -->
        <div id="bot-settings" class="tab-pane">
            <div class="section-header">
                <h2>âš™ï¸ Bot Settings & Configuration</h2>
                <button class="btn btn-primary" onclick="loadBotSettings()">ğŸ”„ Refresh</button>
            </div>

            <!-- Bot Messages Configuration -->
            <div class="moderation-section">
                <h4 style="margin-top: 0;">ğŸ’¬ Bot Messages</h4>

                <div class="form-group">
                    <label>Welcome Message:</label>
                    <textarea id="welcome-message" rows="6"
                        placeholder="Enter welcome message (leave empty for default)"></textarea>
                    <small>Shown when users start the bot with /start</small>
                </div>

                <div class="form-group">
                    <label>Match Found Message:</label>
                    <textarea id="match-found-message" rows="4"
                        placeholder="Enter match found message (leave empty for default)"></textarea>
                    <small>Shown when a chat partner is found</small>
                </div>

                <div class="form-group">
                    <label>Chat End Message (User Ends Chat):</label>
                    <textarea id="chat-end-message" rows="4"
                        placeholder="Enter chat end message (leave empty for default)"></textarea>
                    <small>Shown to user when they end the chat with /stop</small>
                </div>

                <div class="form-group">
                    <label>Partner Left Message (Partner Leaves):</label>
                    <textarea id="partner-left-message" rows="4"
                        placeholder="Enter partner left message (leave empty for default)"></textarea>
                    <small>Shown when partner leaves or skips to next chat</small>
                </div>

                <div class="form-group">
                    <label>Inactivity Auto-Disconnect Duration (seconds):</label>
                    <input type="number" id="inactivity-duration" min="60" max="3600" placeholder="300" value="300">
                    <small>Auto-disconnect after this many seconds of inactivity (minimum 60 seconds)</small>
                </div>

                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn-success" onclick="saveBotMessages()">ğŸ’¾ Save Messages & Duration</button>
                </div>
            </div>

            <!-- Bot Mode Controls -->
            <div class="moderation-section"
                style="background: linear-gradient(135deg, rgba(217, 119, 6, 0.15), rgba(245, 158, 11, 0.15)); border: 1px solid var(--warning-color);">
                <h4 style="margin-top: 0; padding-bottom: 15px;">ğŸ”§ Bot Mode Controls</h4>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div>
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="maintenance-mode" style="width: 20px; height: 20px;">
                            <span style="font-weight: 600;">ğŸ”’ Maintenance Mode</span>
                        </label>
                        <small style="display: block; margin-left: 30px; margin-top: 5px;">Bot will not accept any
                            commands</small>
                    </div>

                    <div>
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="registrations-enabled" checked
                                style="width: 20px; height: 20px;">
                            <span style="font-weight: 600;">âœ… Allow New Registrations</span>
                        </label>
                        <small style="display: block; margin-left: 30px; margin-top: 5px;">New users can start using the
                            bot</small>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn-success" onclick="saveBotModes()">ğŸ’¾ Save Mode Settings</button>
                </div>
            </div>

            <!-- Admin Actions -->
            <div class="moderation-section"
                style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.15), rgba(220, 38, 38, 0.15)); border: 1px solid var(--danger-color);">
                <h4 style="margin-top: 0; color: var(--danger-color); padding-bottom: 15px;">âš ï¸ Critical Admin Actions
                </h4>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <button class="btn-danger" onclick="forceLogoutAll()" style="width: 100%;">
                            ğŸšª Force Logout All Users
                        </button>
                        <small
                            style="display: block; margin-top: 10px; color: var(--text-secondary); text-align: center;">
                            Disconnects all active chats and clears all sessions
                        </small>
                    </div>

                    <div>
                        <button class="btn-danger" onclick="resetQueue()" style="width: 100%;">
                            ğŸ—‘ï¸ Reset Entire Queue
                        </button>
                        <small
                            style="display: block; margin-top: 10px; color: var(--text-secondary); text-align: center;">
                            Removes all users from the matching queue
                        </small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Backups Tab -->
        <div id="backups" class="tab-pane">
            <div class="section-header">
                <h2>ğŸ’¾ Redis Backup Management</h2>
                <button class="btn btn-primary" onclick="loadBackups()">ğŸ”„ Refresh</button>
            </div>

            <!-- Backup Statistics -->
            <div class="stats-grid" style="margin-bottom: 20px;">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“Š</div>
                    <div class="stat-content">
                        <div class="stat-value" id="backup-total-count">-</div>
                        <div class="stat-label">Total Backups</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ’½</div>
                    <div class="stat-content">
                        <div class="stat-value" id="backup-total-size">-</div>
                        <div class="stat-label">Total Size</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ•’</div>
                    <div class="stat-content">
                        <div class="stat-value" id="backup-latest-time">-</div>
                        <div class="stat-label">Latest Backup</div>
                    </div>
                </div>
            </div>

            <!-- Create Backup Section -->
            <div class="moderation-section">
                <h4 style="margin-top: 0;">ğŸ†• Create New Backup</h4>
                <div style="display: flex; align-items: center; gap: 15px; margin: 15px 0;">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="backup-compress" checked>
                        <span>Compress backup (recommended)</span>
                    </label>
                </div>
                <button class="btn-success" onclick="createBackup()">
                    ğŸ’¾ Create Backup Now
                </button>
                <p style="color: var(--text-secondary); margin-top: 10px; font-size: 0.9em;">
                    Creates a complete backup of all Redis data including users, chats, queues, bans, reports, and settings.
                </p>
            </div>

            <!-- Available Backups -->
            <div class="moderation-section">
                <h4 style="margin-top: 0;">ğŸ“‚ Available Backups</h4>
                <div class="table-container">
                    <table class="user-table">
                        <thead>
                            <tr>
                                <th>Created At</th>
                                <th>Filename</th>
                                <th>Size</th>
                                <th>Compressed</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="backups-table">
                            <tr>
                                <td colspan="5" class="loading">Loading backups...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Backup Information -->
            <div class="moderation-section">
                <h4 style="margin-top: 0;">â„¹ï¸ Backup Information</h4>
                <div style="color: var(--text-secondary); line-height: 1.8;">
                    <p><strong>What gets backed up:</strong></p>
                    <ul style="margin: 10px 0;">
                        <li>âœ… All user profiles and preferences</li>
                        <li>âœ… Chat histories and matches</li>
                        <li>âœ… Queue data</li>
                        <li>âœ… Ban records and warnings</li>
                        <li>âœ… Reports and moderation data</li>
                        <li>âœ… All bot settings and configurations</li>
                    </ul>
                    <p><strong>Backup Tips:</strong></p>
                    <ul style="margin: 10px 0;">
                        <li>ğŸ”’ Download important backups and store them safely</li>
                        <li>â° Schedule automatic backups (see BACKUP_SYSTEM.md)</li>
                        <li>ğŸ’¾ Keep at least 7 days of backups</li>
                        <li>ğŸ—œï¸ Use compression to save disk space</li>
                        <li>âœ… Test restore process regularly</li>
                    </ul>
                    <p style="margin-top: 15px;">
                        <strong>For automated backups and detailed instructions, see:</strong><br>
                        <code>BACKUP_SYSTEM.md</code> and <code>BACKUP_QUICKSTART.md</code>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- User Detail Modal -->
    <div id="user-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeUserModal()">&times;</span>
            <h2>User Details</h2>
            <div id="user-details">
                <p class="loading">Loading...</p>
            </div>
        </div>
    </div>
    </div>

    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>

</html>